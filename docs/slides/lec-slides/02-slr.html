<!DOCTYPE html>
<html>
  <head>
    <title>Simple Linear Regression</title>
    <meta charset="utf-8">
    <meta name="author" content="Dr. Maria Tackett" />
    <link rel="stylesheet" href="sta210-slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Simple Linear Regression
## Inference
### Dr. Maria Tackett
### 01.23.19

---




## Announcements 

- Lab 01 due **today at 11:59p**

- HW 01 due Mon, Jan 28 at 11:59p


---

class: middle, center

## Questions from Lab 01? 


---

## Agenda

- Recap: Simple linear regression basics

- `\(R^2\)`

- Inference for regression

---

## Packages and Data



```r
library(tidyverse)
library(broom)
library(modelr)
library(fivethirtyeight)
```


```r
movie_scores &lt;- fandango %&gt;%
  rename(tomatometer = rottentomatoes, audience = rottentomatoes_user)
```

---

## rottentomatoes.com

Can ratings from movie critics be used to predict the ratings from movie goers?

--

&lt;img src="img/03/movie-rating-2.png" width="70%" style="display: block; margin: auto;" /&gt;

--

&lt;img src="img/03/movie-rating-1.png" width="70%" style="display: block; margin: auto;" /&gt;

---

## Critic vs. Audience Ratings

- To answer this question, we will analyze the critic and audience scores from rottentomatoes.com.  
    - The data was first used in the article [Be Suspicious of Online Movie Ratings, Especially Fandango's](https://fivethirtyeight.com/features/fandango-movies-ratings/).

- Variables: 
    - `tomatometer`: Rotten Tomatoes Tomatometer score for the film (0 - 100)
    - `audience`: Rotten Tomatoes user score for the film (0 - 100)

---

## Regression Model 

`$$Y|X \sim N(\beta_0 + \beta_1 X,\sigma^2)$$`

&lt;img src="img/03/regression.png" width="80%" style="display: block; margin: auto;" /&gt;

- `\(\sigma\)`: the standard deviation of `\(Y\)` as a function of `\(X\)` 

- **Assumption:** `\(\sigma\)` is equal for all values of `\(X\)`

---

## Regression Model

.alert[
`$$\color{blue}{Y|X \sim N(\beta_0 + \beta_1 X,\sigma^2)}$$`
]

--

- For a single observation `\((x_i, y_i)\)`

`$$\color{blue}{y_i = \beta_0 + \beta_1 x_i + \epsilon_i \hspace{10mm} \epsilon_i \sim N(0,\sigma^2)}$$`

--

- We want to use the `\(n\)` observations `\((x_1,y_1), \ldots, (x_n, y_n)\)` to estimate `\(\beta_0\)` and `\(\beta_1\)`. We will use *least-squares regression* estimates.

---

## Least-Squares Model


```r
model &lt;- lm(audience ~ tomatometer, data=movie_scores)
tidy(model)
```

```
## # A tibble: 2 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   32.3      2.34        13.8 4.03e-28
## 2 tomatometer    0.519    0.0345      15.0 2.70e-31
```

- **Slope**: For every one percentage increase in the Tomatometer score, we expect the audience score to increase by 0.519%. 

- **Intercept**: If the Tomatometer score is 0%, we expect the audience score to be about 32.316%.

---

## Model Assumptions 

---

## Assumptions for Regression 

1. &lt;font class="vocab"&gt;Linearity: &lt;/font&gt;The plot of the mean value for `\(y\)` against `\(x\)` falls on a straight line

2. &lt;font class="vocab"&gt;Constant Variance: &lt;/font&gt;The regression variance is the same for all values of `\(x\)`

3. &lt;font class="vocab"&gt;Normality: &lt;/font&gt; For a given `\(x\)`, the distribution of `\(y\)` around its mean is Normal

4. &lt;font class="vocab"&gt;Independence: &lt;/font&gt;All observations are independent

---


```r
movie_scores &lt;- movie_scores %&gt;% mutate(residuals=resid(model))
```

```r
ggplot(data=movie_scores,mapping=aes(x=tomatometer, y=residuals)) + 
  geom_point() + 
  geom_hline(yintercept=0,color="red")+
  labs(title="Residuals vs. Tomatometer") +
  theme_gray()
```

&lt;img src="02-slr_files/figure-html/unnamed-chunk-6-1.png" style="display: block; margin: auto;" /&gt;

---

## Normal QQ-Plot

&lt;img src="img/03/normal_qqplot.png" width="100%" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(data=movie_scores,mapping=aes(x=residuals)) + 
  geom_histogram() + 
  labs(title="Distribution of Residuals") +
  theme_gray()
```

&lt;img src="02-slr_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;

---


```r
ggplot(data=movie_scores,mapping=aes(sample=residuals)) + 
  stat_qq() + 
  stat_qq_line() +
  labs(title="Normal QQ Plot of Residuals") +
  theme_gray()
```

&lt;img src="02-slr_files/figure-html/unnamed-chunk-9-1.png" style="display: block; margin: auto;" /&gt;

---

class: middle, center

## Assessing Model Fit

---

## `\(R^2\)`

We can use the coefficient of determination, `\(R^2\)`, to measure how well the model fits the data 

- `\(R^2\)` is the proportion of variation in `\(Y\)` that is explained by the regression line (reported as percentage)

- It is difficult to determine what's a "good" value of `\(R^2\)`. It depends on the context of the data.

---

## Calculating `\(R^2\)`

.instructions[
`$$R^2 = \frac{\text{TSS} - \text{RSS}}{\text{TSS}} = 1 - \frac{\text{RSS}}{\text{TSS}}$$`
]

- &lt;font class="vocab"&gt;Total Sum of Squares: &lt;/font&gt;Total variation in the `\(Y\)`'s before fitting the regression 

`$$\text{TSS}= \sum\limits_{i=1}^{n}(y_i - \bar{y})^2 = (n-1)s^2_y$$`

- &lt;font class="vocab"&gt;Residual Sum of Squares (RSS): &lt;/font&gt;Total variation in the `\(Y\)`'s around the regression line (sum of squared residuals)
`$$\text{RSS} = \sum\limits_{i=1}^{n}[y_i - (\hat{\beta}_0 + \hat{\beta}_1x_i)]^2$$`

---

## Rotten Tomatoes Data


```r
rsquare(model,movie_scores)
```

```
## [1] 0.6106479
```

The Tomatometer score explains about 61.06% of the variation in audience scores on rottentomatoes.com.

---

## Recap 

- Foundation of least-squares regression 

- Estimating &amp; interpreting coefficients

- Checking model assumptions

- `\(R^2\)`

---

class: middle, center

## Git and GitHub

---

## Version control

- We will use GitHub as a platform for assignments and collaboration 

- But it's much more than that...

- It's actually designed for version control

---

## Versioning

&lt;img src="img/01/lego-steps.png" width="80%" style="display: block; margin: auto;" /&gt;

---

## Versioning 

with human readable messages

&lt;img src="img/01/lego-steps-commit-messages.png" width="80%" style="display: block; margin: auto;" /&gt;

---

### Why do we need version control?

&lt;img src="img/01/phd_comics_vc.gif" width="50%" style="display: block; margin: auto;" /&gt;

---

## Git and GitHub tips

- **Git** is a version control system -- like “Track Changes” features from Microsoft Word. 

--

- **GitHub** is the home for your Git-based projects on the internet (like DropBox but much better).

--

- There are a lot of Git commands and very few people know them all. 99% of the time you will use git to add, commit, push, and pull.

---

## Git and GitHub tips

- We will be doing git things and interfacing with GitHub through RStudio
    - If you Google for help you might come across methods for doing these things in the command line -- skip that and move on to the next resource unless you feel comfortable trying it out.

--

- There is a great resource for working with git and R: [happygitwithr.com](http://happygitwithr.com/).
    - Some of the content in there is beyond the scope of this course, but it's a good place to look for help.

--

- You will start using git and GitHub in Lab 01 on Friday.

---

## Before next class 

- Reading 02 posted online - due Wed Jan 23
    - Review inference
    
- If you have not already done so, 
    - Accept the invite to join `STA210-Sp19` organization on GitHub
    - complete "Getting to know you" survey on Sakai 
    - complete Pretest ([test info &amp; access code](https://www2.stat.duke.edu/courses/Spring19/sta210.001/slides/lab-slides/00-lab-slides.html#8))
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_HTMLorMML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
