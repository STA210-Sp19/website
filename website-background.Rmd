---
title: "Simple Website Background Using ggplot2"
subtitle: "Regression Analysis Course"
author: "Dr. Maria Tackett"
date: "12.20.2018"
output: github_document 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning=FALSE,
                      message=FALSE)
```

## Introduction 

This document contains the code used to make the background image for the [STA 210 Spring 2019](https://www2.stat.duke.edu/courses/Spring19/sta210.001/) course website. This background can be used to start a discussion with students about various types of regression models. 


## The Data

The [Capital Bikeshare data](https://archive.ics.uci.edu/ml/datasets/bike+sharing+dataset) is used to create this background. Each plot uses a combination of the following variables: 

- `cnt`: number of bike rentals
- `season`: 1 - Winter, 2 - Spring, 3 - Summer 4 - Fall 
- `atemp`: feeling temperature &#247; 50 (in degrees Celsius)
<br> 

```{r load-packages}
library(tidyverse)
library(readr)
# library(cowplot)
```

```{r data}
bikeshare <- read_csv("https://raw.githubusercontent.com/matackett/data/master/capital-bikeshare.csv")          
```

```{r change-season}
bikeshare <- bikeshare %>%
  mutate(season = case_when(
    season==1 ~ "Winter",
    season==2 ~ "Spring",
    season==3 ~ "Summer",
    season==4 ~ "Fall"
  )) %>% 
  select(season,atemp,cnt)
```

## The Models

```{r k-means}
bike.cl <- kmeans(bikeshare[,2:3], 4, nstart = 20)
bikeshare <- 
  bikeshare %>% 
  mutate(cluster=as.factor(bike.cl$cluster))
ggplot(data=bikeshare,aes(x=atemp,y=cnt,color=cluster)) +
  geom_point(alpha=0.5) +
  theme_minimal()
```

```{r linear-regression}
bikeshare %>%
  ggplot(aes(x=atemp,y=cnt)) + 
  geom_point(aes(color=season)) + 
  geom_smooth(method=lm,color="#606060",se=FALSE)+
  theme_minimal()
```
```{r logistic-data}
bikeshare <- 
  bikeshare %>%
  mutate(is.winter = ifelse(season=="Winter",1,0),
         is.spring = ifelse(season=="Spring",1,0),
         is.summer = ifelse(season=="Summer",1,0),
         is.fall = ifelse(season=="Fall",1,0))
```

```{r logistic}
# glm_model <- glm(is.summer ~ atemp + cnt, data=bikeshare, family=binomial)
# bikeshare <- augment(glm_model,type.predict="response")
ggplot(data=bikeshare,aes(x=atemp,y=is.winter)) +
  geom_point(alpha=0.3) +
  geom_smooth(method="glm",method.args=list(family="binomial"),se=FALSE,color="#00BFC4")+
  geom_smooth(aes(x=atemp,y=is.spring),method="glm",method.args=list(family="binomial"),se=FALSE,color="#F8766D")+
  geom_smooth(aes(x=atemp,y=is.summer),method="glm",method.args=list(family="binomial"),se=FALSE,color="#C77CFF")+
  geom_smooth(aes(x=atemp,y=is.fall),method="glm",method.args=list(family="binomial"),se=FALSE,color="#7CAE00") +
  theme_minimal()
```

## The Plots

A few notes about the plots: 

- The plots used in this background are scatterplot, density plot, contour plot, linear smoothing, side-by-side boxplots, and area plots. See the [ggplot2 cheat sheet](https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf) for details and more plot options.

-  The titles, axes, and legend have been removed for each plot. These elements can be easily added by removing the `theme()` modifier. 

```{r make-plots}
alpha.level = 0.5 

p1 <- ggplot(data=bikeshare,aes(x=atemp,y=cnt,color=season)) +
  geom_point(alpha=alpha.level) +
  theme_void() +
  theme(legend.position="none",
        axis.title=element_blank(),
        axis.text.x=element_blank(),
        axis.text.y=element_blank()
      )

p2 <- ggplot(data=bikeshare,aes(x=cnt,fill=season)) +
  geom_density(alpha=alpha.level) +
  theme_void() +
  theme(legend.position="none",
        axis.title=element_blank(),
        axis.text.x=element_blank(),
        axis.text.y=element_blank()
      )

p3 <- ggplot(data=bikeshare,aes(x=cnt,y=atemp,color=season)) +
  geom_density2d() +
  theme_void() +
  theme(legend.position="none",
        axis.title=element_blank(),
        axis.text.x=element_blank(),
        axis.text.y=element_blank()
      )

p4 <- ggplot(data=bikeshare,aes(x=atemp,y=cnt,color=season)) +
  geom_smooth(se=FALSE) +
  theme_void() +
  theme(legend.position="none",
        axis.title=element_blank(),
        axis.text.x=element_blank(),
        axis.text.y=element_blank()
      )

p5 <- ggplot(data=bikeshare,aes(x=season,y=cnt,fill=season)) +
  geom_boxplot(alpha=alpha.level) +
  theme_void() +
  theme(legend.position="none",
        axis.title=element_blank(),
        axis.text.x=element_blank(),
        axis.text.y=element_blank()
      )

p6 <- ggplot(data=bikeshare,aes(x=cnt,fill=season)) +
  geom_area(stat="bin",alpha=alpha.level,color="black") +
  theme_void() +
  theme(legend.position="none",
        axis.title=element_blank(),
        axis.text.x=element_blank(),
        axis.text.y=element_blank()
      )
plot_grid(p1,p2,p3,p4,p5,p6,ncol=3)
```

```{r save-plot}
# modify file location
ggsave("static/img/bikeshare-plots.png",scale=2)
```


